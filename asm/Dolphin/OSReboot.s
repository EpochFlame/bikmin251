.include "macros.inc"
.section .bss  # 0x804EFC20 - 0x8051467C
.balign 32
.global Header
Header:
	.skip 0x20

.section .sbss # 0x80514D80 - 0x80516360
.balign 8
.global SaveStart
SaveStart:
	.skip 0x4
.global SaveEnd
SaveEnd:
	.skip 0x4
.global Prepared
Prepared:
	.skip 0x8

.section .text, "ax"  # 0x800056C0 - 0x80472F00
.global Run
Run:
/* 800EFF4C 000ECE8C  7C 00 04 AC */	sync 0
/* 800EFF50 000ECE90  4C 00 01 2C */	isync 
/* 800EFF54 000ECE94  7C 68 03 A6 */	mtlr r3
/* 800EFF58 000ECE98  4E 80 00 20 */	blr 

.global Callback
Callback:
/* 800EFF5C 000ECE9C  38 00 00 01 */	li r0, 1
/* 800EFF60 000ECEA0  90 0D 8F A0 */	stw r0, Prepared@sda21(r13)
/* 800EFF64 000ECEA4  4E 80 00 20 */	blr 

.global __OSReboot
__OSReboot:
/* 800EFF68 000ECEA8  7C 08 02 A6 */	mflr r0
/* 800EFF6C 000ECEAC  90 01 00 04 */	stw r0, 4(r1)
/* 800EFF70 000ECEB0  94 21 FC 80 */	stwu r1, -0x380(r1)
/* 800EFF74 000ECEB4  BF 61 03 6C */	stmw r27, 0x36c(r1)
/* 800EFF78 000ECEB8  7C 7B 1B 78 */	mr r27, r3
/* 800EFF7C 000ECEBC  3C 60 80 4F */	lis r3, Header@ha
/* 800EFF80 000ECEC0  3B E3 66 C0 */	addi r31, r3, Header@l
/* 800EFF84 000ECEC4  4B FF EC B5 */	bl OSDisableInterrupts
/* 800EFF88 000ECEC8  80 AD 8F 98 */	lwz r5, SaveStart@sda21(r13)
/* 800EFF8C 000ECECC  3F 80 80 00 */	lis r28, 0x800030F0@ha
/* 800EFF90 000ECED0  38 C0 00 01 */	li r6, 1
/* 800EFF94 000ECED4  80 0D 8F 9C */	lwz r0, SaveEnd@sda21(r13)
/* 800EFF98 000ECED8  3C 80 81 30 */	lis r4, 0x812FDFF0@ha
/* 800EFF9C 000ECEDC  93 7C 30 F0 */	stw r27, 0x800030F0@l(r28)
/* 800EFFA0 000ECEE0  38 61 00 A0 */	addi r3, r1, 0xa0
/* 800EFFA4 000ECEE4  98 DC 30 E2 */	stb r6, 0x30e2(r28)
/* 800EFFA8 000ECEE8  90 A4 DF F0 */	stw r5, 0x812FDFF0@l(r4)
/* 800EFFAC 000ECEEC  90 04 DF EC */	stw r0, -0x2014(r4)
/* 800EFFB0 000ECEF0  4B FF D1 BD */	bl OSClearContext
/* 800EFFB4 000ECEF4  38 61 00 A0 */	addi r3, r1, 0xa0
/* 800EFFB8 000ECEF8  4B FF CF ED */	bl OSSetCurrentContext
/* 800EFFBC 000ECEFC  4B FE CD 71 */	bl DVDInit
/* 800EFFC0 000ECF00  38 60 00 01 */	li r3, 1
/* 800EFFC4 000ECF04  4B FE EE 99 */	bl DVDSetAutoInvalidation
/* 800EFFC8 000ECF08  4B FE EE A5 */	bl DVDResume
/* 800EFFCC 000ECF0C  3B 60 00 00 */	li r27, 0
/* 800EFFD0 000ECF10  3C 60 80 0F */	lis r3, Callback@ha
/* 800EFFD4 000ECF14  93 6D 8F A0 */	stw r27, Prepared@sda21(r13)
/* 800EFFD8 000ECF18  38 63 FF 5C */	addi r3, r3, Callback@l
/* 800EFFDC 000ECF1C  4B FE F3 2D */	bl __DVDPrepareResetAsync
/* 800EFFE0 000ECF20  38 60 FF E0 */	li r3, -32
/* 800EFFE4 000ECF24  4B FF F0 1D */	bl __OSMaskInterrupts
/* 800EFFE8 000ECF28  38 60 04 00 */	li r3, 0x400
/* 800EFFEC 000ECF2C  4B FF F0 9D */	bl __OSUnmaskInterrupts
/* 800EFFF0 000ECF30  4B FF EC 5D */	bl OSEnableInterrupts
/* 800EFFF4 000ECF34  48 00 2B 9D */	bl OSGetTime
/* 800EFFF8 000ECF38  7C 9E 23 78 */	mr r30, r4
/* 800EFFFC 000ECF3C  7C 7D 1B 78 */	mr r29, r3
/* 800F0000 000ECF40  48 00 00 04 */	b .L_800F0004
.L_800F0004:
/* 800F0004 000ECF44  80 1C 00 F8 */	lwz r0, 0xf8(r28)
/* 800F0008 000ECF48  6F 7B 80 00 */	xoris r27, r27, 0x8000
/* 800F000C 000ECF4C  54 1C F0 BE */	srwi r28, r0, 2
/* 800F0010 000ECF50  48 00 00 04 */	b .L_800F0014
.L_800F0014:
/* 800F0014 000ECF54  48 00 00 40 */	b .L_800F0054
.L_800F0018:
/* 800F0018 000ECF58  4B FE F1 F9 */	bl DVDCheckDisk
/* 800F001C 000ECF5C  2C 03 00 00 */	cmpwi r3, 0
/* 800F0020 000ECF60  41 82 00 2C */	beq .L_800F004C
/* 800F0024 000ECF64  48 00 2B 6D */	bl OSGetTime
/* 800F0028 000ECF68  7C 9E 20 10 */	subfc r4, r30, r4
/* 800F002C 000ECF6C  7C 1D 19 10 */	subfe r0, r29, r3
/* 800F0030 000ECF70  6C 03 80 00 */	xoris r3, r0, 0x8000
/* 800F0034 000ECF74  7C 04 E0 10 */	subfc r0, r4, r28
/* 800F0038 000ECF78  7C 63 D9 10 */	subfe r3, r3, r27
/* 800F003C 000ECF7C  7C 7B D9 10 */	subfe r3, r27, r27
/* 800F0040 000ECF80  7C 63 00 D0 */	neg r3, r3
/* 800F0044 000ECF84  2C 03 00 00 */	cmpwi r3, 0
/* 800F0048 000ECF88  41 82 00 0C */	beq .L_800F0054
.L_800F004C:
/* 800F004C 000ECF8C  38 60 00 00 */	li r3, 0
/* 800F0050 000ECF90  48 00 03 49 */	bl __OSDoHotReset
.L_800F0054:
/* 800F0054 000ECF94  80 0D 8F A0 */	lwz r0, Prepared@sda21(r13)
/* 800F0058 000ECF98  2C 00 00 01 */	cmpwi r0, 1
/* 800F005C 000ECF9C  40 82 FF BC */	bne .L_800F0018
/* 800F0060 000ECFA0  80 0D 8F 1C */	lwz r0, __OSIsGcam@sda21(r13)
/* 800F0064 000ECFA4  2C 00 00 00 */	cmpwi r0, 0
/* 800F0068 000ECFA8  40 82 00 C4 */	bne .L_800F012C
/* 800F006C 000ECFAC  4B FE F1 9D */	bl DVDGetCurrentDiskID
/* 800F0070 000ECFB0  88 03 00 08 */	lbz r0, 8(r3)
/* 800F0074 000ECFB4  28 00 00 00 */	cmplwi r0, 0
/* 800F0078 000ECFB8  41 82 00 0C */	beq .L_800F0084
/* 800F007C 000ECFBC  38 00 00 01 */	li r0, 1
/* 800F0080 000ECFC0  48 00 00 08 */	b .L_800F0088
.L_800F0084:
/* 800F0084 000ECFC4  38 00 00 00 */	li r0, 0
.L_800F0088:
/* 800F0088 000ECFC8  2C 00 00 00 */	cmpwi r0, 0
/* 800F008C 000ECFCC  41 82 00 A0 */	beq .L_800F012C
/* 800F0090 000ECFD0  38 60 00 00 */	li r3, 0
/* 800F0094 000ECFD4  48 00 6B 8D */	bl AISetStreamVolLeft
/* 800F0098 000ECFD8  38 60 00 00 */	li r3, 0
/* 800F009C 000ECFDC  48 00 6B B1 */	bl AISetStreamVolRight
/* 800F00A0 000ECFE0  38 61 00 70 */	addi r3, r1, 0x70
/* 800F00A4 000ECFE4  38 80 00 00 */	li r4, 0
/* 800F00A8 000ECFE8  4B FE EA ED */	bl DVDCancelStreamAsync
/* 800F00AC 000ECFEC  48 00 2A E5 */	bl OSGetTime
/* 800F00B0 000ECFF0  7C 9E 23 78 */	mr r30, r4
/* 800F00B4 000ECFF4  7C 7D 1B 78 */	mr r29, r3
/* 800F00B8 000ECFF8  48 00 00 04 */	b .L_800F00BC
.L_800F00BC:
/* 800F00BC 000ECFFC  3C 60 80 00 */	lis r3, 0x800000F8@ha
/* 800F00C0 000ED000  80 63 00 F8 */	lwz r3, 0x800000F8@l(r3)
/* 800F00C4 000ED004  38 00 00 00 */	li r0, 0
/* 800F00C8 000ED008  6C 1B 80 00 */	xoris r27, r0, 0x8000
/* 800F00CC 000ED00C  54 7C F0 BE */	srwi r28, r3, 2
/* 800F00D0 000ED010  48 00 00 04 */	b .L_800F00D4
.L_800F00D4:
/* 800F00D4 000ED014  48 00 00 40 */	b .L_800F0114
.L_800F00D8:
/* 800F00D8 000ED018  4B FE F1 39 */	bl DVDCheckDisk
/* 800F00DC 000ED01C  2C 03 00 00 */	cmpwi r3, 0
/* 800F00E0 000ED020  41 82 00 2C */	beq .L_800F010C
/* 800F00E4 000ED024  48 00 2A AD */	bl OSGetTime
/* 800F00E8 000ED028  7C 9E 20 10 */	subfc r4, r30, r4
/* 800F00EC 000ED02C  7C 1D 19 10 */	subfe r0, r29, r3
/* 800F00F0 000ED030  6C 03 80 00 */	xoris r3, r0, 0x8000
/* 800F00F4 000ED034  7C 04 E0 10 */	subfc r0, r4, r28
/* 800F00F8 000ED038  7C 63 D9 10 */	subfe r3, r3, r27
/* 800F00FC 000ED03C  7C 7B D9 10 */	subfe r3, r27, r27
/* 800F0100 000ED040  7C 63 00 D0 */	neg r3, r3
/* 800F0104 000ED044  2C 03 00 00 */	cmpwi r3, 0
/* 800F0108 000ED048  41 82 00 0C */	beq .L_800F0114
.L_800F010C:
/* 800F010C 000ED04C  38 60 00 00 */	li r3, 0
/* 800F0110 000ED050  48 00 02 89 */	bl __OSDoHotReset
.L_800F0114:
/* 800F0114 000ED054  38 61 00 70 */	addi r3, r1, 0x70
/* 800F0118 000ED058  4B FE EC 4D */	bl DVDGetCommandBlockStatus
/* 800F011C 000ED05C  2C 03 00 00 */	cmpwi r3, 0
/* 800F0120 000ED060  40 82 FF B8 */	bne .L_800F00D8
/* 800F0124 000ED064  38 60 00 00 */	li r3, 0
/* 800F0128 000ED068  48 00 68 39 */	bl AISetStreamPlayState
.L_800F012C:
/* 800F012C 000ED06C  7F E4 FB 78 */	mr r4, r31
/* 800F0130 000ED070  38 61 00 40 */	addi r3, r1, 0x40
/* 800F0134 000ED074  38 A0 00 20 */	li r5, 0x20
/* 800F0138 000ED078  38 C0 24 40 */	li r6, 0x2440
/* 800F013C 000ED07C  38 E0 00 00 */	li r7, 0
/* 800F0140 000ED080  39 00 00 00 */	li r8, 0
/* 800F0144 000ED084  4B FE E7 D1 */	bl DVDReadAbsAsyncPrio
/* 800F0148 000ED088  48 00 2A 49 */	bl OSGetTime
/* 800F014C 000ED08C  7C 9B 23 78 */	mr r27, r4
/* 800F0150 000ED090  7C 7E 1B 78 */	mr r30, r3
/* 800F0154 000ED094  48 00 00 04 */	b .L_800F0158
.L_800F0158:
/* 800F0158 000ED098  3C 60 80 00 */	lis r3, 0x800000F8@ha
/* 800F015C 000ED09C  80 63 00 F8 */	lwz r3, 0x800000F8@l(r3)
/* 800F0160 000ED0A0  38 00 00 00 */	li r0, 0
/* 800F0164 000ED0A4  6C 1C 80 00 */	xoris r28, r0, 0x8000
/* 800F0168 000ED0A8  54 7D F0 BE */	srwi r29, r3, 2
/* 800F016C 000ED0AC  48 00 00 04 */	b .L_800F0170
.L_800F0170:
/* 800F0170 000ED0B0  48 00 00 40 */	b .L_800F01B0
.L_800F0174:
/* 800F0174 000ED0B4  4B FE F0 9D */	bl DVDCheckDisk
/* 800F0178 000ED0B8  2C 03 00 00 */	cmpwi r3, 0
/* 800F017C 000ED0BC  41 82 00 2C */	beq .L_800F01A8
/* 800F0180 000ED0C0  48 00 2A 11 */	bl OSGetTime
/* 800F0184 000ED0C4  7C 9B 20 10 */	subfc r4, r27, r4
/* 800F0188 000ED0C8  7C 1E 19 10 */	subfe r0, r30, r3
/* 800F018C 000ED0CC  6C 03 80 00 */	xoris r3, r0, 0x8000
/* 800F0190 000ED0D0  7C 04 E8 10 */	subfc r0, r4, r29
/* 800F0194 000ED0D4  7C 63 E1 10 */	subfe r3, r3, r28
/* 800F0198 000ED0D8  7C 7C E1 10 */	subfe r3, r28, r28
/* 800F019C 000ED0DC  7C 63 00 D0 */	neg r3, r3
/* 800F01A0 000ED0E0  2C 03 00 00 */	cmpwi r3, 0
/* 800F01A4 000ED0E4  41 82 00 0C */	beq .L_800F01B0
.L_800F01A8:
/* 800F01A8 000ED0E8  38 60 00 00 */	li r3, 0
/* 800F01AC 000ED0EC  48 00 01 ED */	bl __OSDoHotReset
.L_800F01B0:
/* 800F01B0 000ED0F0  38 61 00 40 */	addi r3, r1, 0x40
/* 800F01B4 000ED0F4  4B FE EB B1 */	bl DVDGetCommandBlockStatus
/* 800F01B8 000ED0F8  2C 03 00 00 */	cmpwi r3, 0
/* 800F01BC 000ED0FC  40 82 FF B8 */	bne .L_800F0174
/* 800F01C0 000ED100  80 BF 00 18 */	lwz r5, 0x18(r31)
/* 800F01C4 000ED104  38 61 00 10 */	addi r3, r1, 0x10
/* 800F01C8 000ED108  80 DF 00 14 */	lwz r6, 0x14(r31)
/* 800F01CC 000ED10C  3C 80 81 30 */	lis r4, 0x8130
/* 800F01D0 000ED110  38 05 00 1F */	addi r0, r5, 0x1f
/* 800F01D4 000ED114  38 C6 00 20 */	addi r6, r6, 0x20
/* 800F01D8 000ED118  54 1B 00 34 */	rlwinm r27, r0, 0, 0, 0x1a
/* 800F01DC 000ED11C  7F 65 DB 78 */	mr r5, r27
/* 800F01E0 000ED120  38 C6 24 40 */	addi r6, r6, 0x2440
/* 800F01E4 000ED124  38 E0 00 00 */	li r7, 0
/* 800F01E8 000ED128  39 00 00 00 */	li r8, 0
/* 800F01EC 000ED12C  4B FE E7 29 */	bl DVDReadAbsAsyncPrio
/* 800F01F0 000ED130  48 00 29 A1 */	bl OSGetTime
/* 800F01F4 000ED134  7C 9C 23 78 */	mr r28, r4
/* 800F01F8 000ED138  7C 7D 1B 78 */	mr r29, r3
/* 800F01FC 000ED13C  48 00 00 04 */	b .L_800F0200
.L_800F0200:
/* 800F0200 000ED140  3C 60 80 00 */	lis r3, 0x800000F8@ha
/* 800F0204 000ED144  80 63 00 F8 */	lwz r3, 0x800000F8@l(r3)
/* 800F0208 000ED148  38 00 00 00 */	li r0, 0
/* 800F020C 000ED14C  6C 1F 80 00 */	xoris r31, r0, 0x8000
/* 800F0210 000ED150  54 7E F0 BE */	srwi r30, r3, 2
/* 800F0214 000ED154  48 00 00 04 */	b .L_800F0218
.L_800F0218:
/* 800F0218 000ED158  48 00 00 40 */	b .L_800F0258
.L_800F021C:
/* 800F021C 000ED15C  4B FE EF F5 */	bl DVDCheckDisk
/* 800F0220 000ED160  2C 03 00 00 */	cmpwi r3, 0
/* 800F0224 000ED164  41 82 00 2C */	beq .L_800F0250
/* 800F0228 000ED168  48 00 29 69 */	bl OSGetTime
/* 800F022C 000ED16C  7C 9C 20 10 */	subfc r4, r28, r4
/* 800F0230 000ED170  7C 1D 19 10 */	subfe r0, r29, r3
/* 800F0234 000ED174  6C 03 80 00 */	xoris r3, r0, 0x8000
/* 800F0238 000ED178  7C 04 F0 10 */	subfc r0, r4, r30
/* 800F023C 000ED17C  7C 63 F9 10 */	subfe r3, r3, r31
/* 800F0240 000ED180  7C 7F F9 10 */	subfe r3, r31, r31
/* 800F0244 000ED184  7C 63 00 D0 */	neg r3, r3
/* 800F0248 000ED188  2C 03 00 00 */	cmpwi r3, 0
/* 800F024C 000ED18C  41 82 00 0C */	beq .L_800F0258
.L_800F0250:
/* 800F0250 000ED190  38 60 00 00 */	li r3, 0
/* 800F0254 000ED194  48 00 01 45 */	bl __OSDoHotReset
.L_800F0258:
/* 800F0258 000ED198  38 61 00 10 */	addi r3, r1, 0x10
/* 800F025C 000ED19C  4B FE EB 09 */	bl DVDGetCommandBlockStatus
/* 800F0260 000ED1A0  2C 03 00 00 */	cmpwi r3, 0
/* 800F0264 000ED1A4  40 82 FF B8 */	bne .L_800F021C
/* 800F0268 000ED1A8  3C 60 81 30 */	lis r3, 0x8130
/* 800F026C 000ED1AC  7F 64 DB 78 */	mr r4, r27
/* 800F0270 000ED1B0  4B FF C5 8D */	bl ICInvalidateRange
/* 800F0274 000ED1B4  4B FF E9 C5 */	bl OSDisableInterrupts
/* 800F0278 000ED1B8  4B FF C5 B9 */	bl ICFlashInvalidate
/* 800F027C 000ED1BC  3C 60 81 30 */	lis r3, 0x8130
/* 800F0280 000ED1C0  4B FF FC CD */	bl Run
/* 800F0284 000ED1C4  BB 61 03 6C */	lmw r27, 0x36c(r1)
/* 800F0288 000ED1C8  80 01 03 84 */	lwz r0, 0x384(r1)
/* 800F028C 000ED1CC  38 21 03 80 */	addi r1, r1, 0x380
/* 800F0290 000ED1D0  7C 08 03 A6 */	mtlr r0
/* 800F0294 000ED1D4  4E 80 00 20 */	blr 

.global OSSetSaveRegion
OSSetSaveRegion:
/* 800F0298 000ED1D8  90 6D 8F 98 */	stw r3, SaveStart@sda21(r13)
/* 800F029C 000ED1DC  90 8D 8F 9C */	stw r4, SaveEnd@sda21(r13)
/* 800F02A0 000ED1E0  4E 80 00 20 */	blr 
