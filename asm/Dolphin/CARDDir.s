.include "macros.inc"

.section .text, "ax"  # 0x800056C0 - 0x80472F00
.global __CARDGetDirBlock
__CARDGetDirBlock:
/* 800D7168 000D40A8  80 63 00 84 */	lwz r3, 0x84(r3)
/* 800D716C 000D40AC  4E 80 00 20 */	blr 

WriteCallback:
/* 800D7170 000D40B0  7C 08 02 A6 */	mflr r0
/* 800D7174 000D40B4  90 01 00 04 */	stw r0, 4(r1)
/* 800D7178 000D40B8  94 21 FF E0 */	stwu r1, -0x20(r1)
/* 800D717C 000D40BC  93 E1 00 1C */	stw r31, 0x1c(r1)
/* 800D7180 000D40C0  93 C1 00 18 */	stw r30, 0x18(r1)
/* 800D7184 000D40C4  7C 9E 23 79 */	or. r30, r4, r4
/* 800D7188 000D40C8  93 A1 00 14 */	stw r29, 0x14(r1)
/* 800D718C 000D40CC  3B A3 00 00 */	addi r29, r3, 0
/* 800D7190 000D40D0  1C BD 01 10 */	mulli r5, r29, 0x110
/* 800D7194 000D40D4  3C 60 80 4F */	lis r3, __CARDBlock@ha
/* 800D7198 000D40D8  38 03 5A F0 */	addi r0, r3, __CARDBlock@l
/* 800D719C 000D40DC  7F E0 2A 14 */	add r31, r0, r5
/* 800D71A0 000D40E0  41 80 00 44 */	blt .L_800D71E4
/* 800D71A4 000D40E4  80 7F 00 80 */	lwz r3, 0x80(r31)
/* 800D71A8 000D40E8  80 1F 00 84 */	lwz r0, 0x84(r31)
/* 800D71AC 000D40EC  38 83 20 00 */	addi r4, r3, 0x2000
/* 800D71B0 000D40F0  7C 00 20 40 */	cmplw r0, r4
/* 800D71B4 000D40F4  38 03 40 00 */	addi r0, r3, 0x4000
/* 800D71B8 000D40F8  40 82 00 18 */	bne .L_800D71D0
/* 800D71BC 000D40FC  90 1F 00 84 */	stw r0, 0x84(r31)
/* 800D71C0 000D4100  7C 03 03 78 */	mr r3, r0
/* 800D71C4 000D4104  38 A0 20 00 */	li r5, 0x2000
/* 800D71C8 000D4108  4B F2 DF D5 */	bl memcpy
/* 800D71CC 000D410C  48 00 00 18 */	b .L_800D71E4
.L_800D71D0:
/* 800D71D0 000D4110  90 9F 00 84 */	stw r4, 0x84(r31)
/* 800D71D4 000D4114  38 64 00 00 */	addi r3, r4, 0
/* 800D71D8 000D4118  7C 04 03 78 */	mr r4, r0
/* 800D71DC 000D411C  38 A0 20 00 */	li r5, 0x2000
/* 800D71E0 000D4120  4B F2 DF BD */	bl memcpy
.L_800D71E4:
/* 800D71E4 000D4124  80 1F 00 D0 */	lwz r0, 0xd0(r31)
/* 800D71E8 000D4128  28 00 00 00 */	cmplwi r0, 0
/* 800D71EC 000D412C  40 82 00 10 */	bne .L_800D71FC
/* 800D71F0 000D4130  38 7F 00 00 */	addi r3, r31, 0
/* 800D71F4 000D4134  38 9E 00 00 */	addi r4, r30, 0
/* 800D71F8 000D4138  4B FF E4 8D */	bl __CARDPutControlBlock
.L_800D71FC:
/* 800D71FC 000D413C  80 1F 00 D8 */	lwz r0, 0xd8(r31)
/* 800D7200 000D4140  28 00 00 00 */	cmplwi r0, 0
/* 800D7204 000D4144  7C 0C 03 78 */	mr r12, r0
/* 800D7208 000D4148  41 82 00 1C */	beq .L_800D7224
/* 800D720C 000D414C  38 00 00 00 */	li r0, 0
/* 800D7210 000D4150  7D 88 03 A6 */	mtlr r12
/* 800D7214 000D4154  90 1F 00 D8 */	stw r0, 0xd8(r31)
/* 800D7218 000D4158  38 7D 00 00 */	addi r3, r29, 0
/* 800D721C 000D415C  38 9E 00 00 */	addi r4, r30, 0
/* 800D7220 000D4160  4E 80 00 21 */	blrl 
.L_800D7224:
/* 800D7224 000D4164  80 01 00 24 */	lwz r0, 0x24(r1)
/* 800D7228 000D4168  83 E1 00 1C */	lwz r31, 0x1c(r1)
/* 800D722C 000D416C  83 C1 00 18 */	lwz r30, 0x18(r1)
/* 800D7230 000D4170  83 A1 00 14 */	lwz r29, 0x14(r1)
/* 800D7234 000D4174  38 21 00 20 */	addi r1, r1, 0x20
/* 800D7238 000D4178  7C 08 03 A6 */	mtlr r0
/* 800D723C 000D417C  4E 80 00 20 */	blr 

EraseCallback:
/* 800D7240 000D4180  7C 08 02 A6 */	mflr r0
/* 800D7244 000D4184  90 01 00 04 */	stw r0, 4(r1)
/* 800D7248 000D4188  94 21 FF D8 */	stwu r1, -0x28(r1)
/* 800D724C 000D418C  93 E1 00 24 */	stw r31, 0x24(r1)
/* 800D7250 000D4190  3B E3 00 00 */	addi r31, r3, 0
/* 800D7254 000D4194  3C 60 80 4F */	lis r3, __CARDBlock@ha
/* 800D7258 000D4198  93 C1 00 20 */	stw r30, 0x20(r1)
/* 800D725C 000D419C  1C BF 01 10 */	mulli r5, r31, 0x110
/* 800D7260 000D41A0  93 A1 00 1C */	stw r29, 0x1c(r1)
/* 800D7264 000D41A4  38 03 5A F0 */	addi r0, r3, __CARDBlock@l
/* 800D7268 000D41A8  7C 9D 23 79 */	or. r29, r4, r4
/* 800D726C 000D41AC  7F C0 2A 14 */	add r30, r0, r5
/* 800D7270 000D41B0  41 80 00 3C */	blt .L_800D72AC
/* 800D7274 000D41B4  80 BE 00 84 */	lwz r5, 0x84(r30)
/* 800D7278 000D41B8  3C 60 80 0D */	lis r3, WriteCallback@ha
/* 800D727C 000D41BC  80 1E 00 80 */	lwz r0, 0x80(r30)
/* 800D7280 000D41C0  38 E3 71 70 */	addi r7, r3, WriteCallback@l
/* 800D7284 000D41C4  80 7E 00 0C */	lwz r3, 0xc(r30)
/* 800D7288 000D41C8  7C 00 28 50 */	subf r0, r0, r5
/* 800D728C 000D41CC  54 00 9B 7E */	srwi r0, r0, 0xd
/* 800D7290 000D41D0  7C 83 01 D6 */	mullw r4, r3, r0
/* 800D7294 000D41D4  38 C5 00 00 */	addi r6, r5, 0
/* 800D7298 000D41D8  38 7F 00 00 */	addi r3, r31, 0
/* 800D729C 000D41DC  38 A0 20 00 */	li r5, 0x2000
/* 800D72A0 000D41E0  4B FF FA FD */	bl __CARDWrite
/* 800D72A4 000D41E4  7C 7D 1B 79 */	or. r29, r3, r3
/* 800D72A8 000D41E8  40 80 00 44 */	bge .L_800D72EC
.L_800D72AC:
/* 800D72AC 000D41EC  80 1E 00 D0 */	lwz r0, 0xd0(r30)
/* 800D72B0 000D41F0  28 00 00 00 */	cmplwi r0, 0
/* 800D72B4 000D41F4  40 82 00 10 */	bne .L_800D72C4
/* 800D72B8 000D41F8  38 7E 00 00 */	addi r3, r30, 0
/* 800D72BC 000D41FC  38 9D 00 00 */	addi r4, r29, 0
/* 800D72C0 000D4200  4B FF E3 C5 */	bl __CARDPutControlBlock
.L_800D72C4:
/* 800D72C4 000D4204  80 1E 00 D8 */	lwz r0, 0xd8(r30)
/* 800D72C8 000D4208  28 00 00 00 */	cmplwi r0, 0
/* 800D72CC 000D420C  7C 0C 03 78 */	mr r12, r0
/* 800D72D0 000D4210  41 82 00 1C */	beq .L_800D72EC
/* 800D72D4 000D4214  38 00 00 00 */	li r0, 0
/* 800D72D8 000D4218  7D 88 03 A6 */	mtlr r12
/* 800D72DC 000D421C  90 1E 00 D8 */	stw r0, 0xd8(r30)
/* 800D72E0 000D4220  38 7F 00 00 */	addi r3, r31, 0
/* 800D72E4 000D4224  38 9D 00 00 */	addi r4, r29, 0
/* 800D72E8 000D4228  4E 80 00 21 */	blrl 
.L_800D72EC:
/* 800D72EC 000D422C  80 01 00 2C */	lwz r0, 0x2c(r1)
/* 800D72F0 000D4230  83 E1 00 24 */	lwz r31, 0x24(r1)
/* 800D72F4 000D4234  83 C1 00 20 */	lwz r30, 0x20(r1)
/* 800D72F8 000D4238  83 A1 00 1C */	lwz r29, 0x1c(r1)
/* 800D72FC 000D423C  38 21 00 28 */	addi r1, r1, 0x28
/* 800D7300 000D4240  7C 08 03 A6 */	mtlr r0
/* 800D7304 000D4244  4E 80 00 20 */	blr 

.global __CARDUpdateDir
__CARDUpdateDir:
/* 800D7308 000D4248  7C 08 02 A6 */	mflr r0
/* 800D730C 000D424C  90 01 00 04 */	stw r0, 4(r1)
/* 800D7310 000D4250  94 21 FF D8 */	stwu r1, -0x28(r1)
/* 800D7314 000D4254  93 E1 00 24 */	stw r31, 0x24(r1)
/* 800D7318 000D4258  93 C1 00 20 */	stw r30, 0x20(r1)
/* 800D731C 000D425C  93 A1 00 1C */	stw r29, 0x1c(r1)
/* 800D7320 000D4260  3B A4 00 00 */	addi r29, r4, 0
/* 800D7324 000D4264  93 81 00 18 */	stw r28, 0x18(r1)
/* 800D7328 000D4268  3B 83 00 00 */	addi r28, r3, 0
/* 800D732C 000D426C  1C BC 01 10 */	mulli r5, r28, 0x110
/* 800D7330 000D4270  3C 60 80 4F */	lis r3, __CARDBlock@ha
/* 800D7334 000D4274  38 03 5A F0 */	addi r0, r3, __CARDBlock@l
/* 800D7338 000D4278  7F C0 2A 14 */	add r30, r0, r5
/* 800D733C 000D427C  80 1E 00 00 */	lwz r0, 0(r30)
/* 800D7340 000D4280  2C 00 00 00 */	cmpwi r0, 0
/* 800D7344 000D4284  40 82 00 0C */	bne .L_800D7350
/* 800D7348 000D4288  38 60 FF FD */	li r3, -3
/* 800D734C 000D428C  48 00 00 60 */	b .L_800D73AC
.L_800D7350:
/* 800D7350 000D4290  83 FE 00 84 */	lwz r31, 0x84(r30)
/* 800D7354 000D4294  38 80 1F FC */	li r4, 0x1ffc
/* 800D7358 000D4298  A8 BF 1F FA */	lha r5, 0x1ffa(r31)
/* 800D735C 000D429C  38 DF 1F C0 */	addi r6, r31, 0x1fc0
/* 800D7360 000D42A0  38 7F 00 00 */	addi r3, r31, 0
/* 800D7364 000D42A4  38 05 00 01 */	addi r0, r5, 1
/* 800D7368 000D42A8  B0 1F 1F FA */	sth r0, 0x1ffa(r31)
/* 800D736C 000D42AC  38 A6 00 3C */	addi r5, r6, 0x3c
/* 800D7370 000D42B0  38 C6 00 3E */	addi r6, r6, 0x3e
/* 800D7374 000D42B4  48 00 00 59 */	bl __CARDCheckSum
/* 800D7378 000D42B8  38 7F 00 00 */	addi r3, r31, 0
/* 800D737C 000D42BC  38 80 20 00 */	li r4, 0x2000
/* 800D7380 000D42C0  48 01 53 C9 */	bl DCStoreRange
/* 800D7384 000D42C4  93 BE 00 D8 */	stw r29, 0xd8(r30)
/* 800D7388 000D42C8  3C 60 80 0D */	lis r3, EraseCallback@ha
/* 800D738C 000D42CC  38 A3 72 40 */	addi r5, r3, EraseCallback@l
/* 800D7390 000D42D0  80 1E 00 80 */	lwz r0, 0x80(r30)
/* 800D7394 000D42D4  7F 83 E3 78 */	mr r3, r28
/* 800D7398 000D42D8  80 9E 00 0C */	lwz r4, 0xc(r30)
/* 800D739C 000D42DC  7C 00 F8 50 */	subf r0, r0, r31
/* 800D73A0 000D42E0  54 00 9B 7E */	srwi r0, r0, 0xd
/* 800D73A4 000D42E4  7C 84 01 D6 */	mullw r4, r4, r0
/* 800D73A8 000D42E8  4B FF E0 59 */	bl __CARDEraseSector
.L_800D73AC:
/* 800D73AC 000D42EC  80 01 00 2C */	lwz r0, 0x2c(r1)
/* 800D73B0 000D42F0  83 E1 00 24 */	lwz r31, 0x24(r1)
/* 800D73B4 000D42F4  83 C1 00 20 */	lwz r30, 0x20(r1)
/* 800D73B8 000D42F8  83 A1 00 1C */	lwz r29, 0x1c(r1)
/* 800D73BC 000D42FC  83 81 00 18 */	lwz r28, 0x18(r1)
/* 800D73C0 000D4300  38 21 00 28 */	addi r1, r1, 0x28
/* 800D73C4 000D4304  7C 08 03 A6 */	mtlr r0
/* 800D73C8 000D4308  4E 80 00 20 */	blr 
