.include "macros.inc"

.section .text, "ax"  # 0x800056C0 - 0x80472F00
.global __CARDGetFatBlock
__CARDGetFatBlock:
/* 800D6E00 000D3D40  80 63 00 88 */	lwz r3, 0x88(r3)
/* 800D6E04 000D3D44  4E 80 00 20 */	blr 

.global WriteCallback
WriteCallback:
/* 800D6E08 000D3D48  7C 08 02 A6 */	mflr r0
/* 800D6E0C 000D3D4C  90 01 00 04 */	stw r0, 4(r1)
/* 800D6E10 000D3D50  94 21 FF E0 */	stwu r1, -0x20(r1)
/* 800D6E14 000D3D54  93 E1 00 1C */	stw r31, 0x1c(r1)
/* 800D6E18 000D3D58  93 C1 00 18 */	stw r30, 0x18(r1)
/* 800D6E1C 000D3D5C  7C 9E 23 79 */	or. r30, r4, r4
/* 800D6E20 000D3D60  93 A1 00 14 */	stw r29, 0x14(r1)
/* 800D6E24 000D3D64  3B A3 00 00 */	addi r29, r3, 0
/* 800D6E28 000D3D68  1C BD 01 10 */	mulli r5, r29, 0x110
/* 800D6E2C 000D3D6C  3C 60 80 4F */	lis r3, __CARDBlock@ha
/* 800D6E30 000D3D70  38 03 5A F0 */	addi r0, r3, __CARDBlock@l
/* 800D6E34 000D3D74  7F E0 2A 14 */	add r31, r0, r5
/* 800D6E38 000D3D78  41 80 00 48 */	blt .L_800D6E80
/* 800D6E3C 000D3D7C  80 7F 00 80 */	lwz r3, 0x80(r31)
/* 800D6E40 000D3D80  80 1F 00 88 */	lwz r0, 0x88(r31)
/* 800D6E44 000D3D84  38 83 60 00 */	addi r4, r3, 0x6000
/* 800D6E48 000D3D88  7C 00 20 40 */	cmplw r0, r4
/* 800D6E4C 000D3D8C  3C A3 00 01 */	addis r5, r3, 1
/* 800D6E50 000D3D90  38 A5 80 00 */	addi r5, r5, -32768
/* 800D6E54 000D3D94  40 82 00 18 */	bne .L_800D6E6C
/* 800D6E58 000D3D98  90 BF 00 88 */	stw r5, 0x88(r31)
/* 800D6E5C 000D3D9C  38 65 00 00 */	addi r3, r5, 0
/* 800D6E60 000D3DA0  38 A0 20 00 */	li r5, 0x2000
/* 800D6E64 000D3DA4  4B F2 E3 39 */	bl memcpy
/* 800D6E68 000D3DA8  48 00 00 18 */	b .L_800D6E80
.L_800D6E6C:
/* 800D6E6C 000D3DAC  90 9F 00 88 */	stw r4, 0x88(r31)
/* 800D6E70 000D3DB0  38 64 00 00 */	addi r3, r4, 0
/* 800D6E74 000D3DB4  38 85 00 00 */	addi r4, r5, 0
/* 800D6E78 000D3DB8  38 A0 20 00 */	li r5, 0x2000
/* 800D6E7C 000D3DBC  4B F2 E3 21 */	bl memcpy
.L_800D6E80:
/* 800D6E80 000D3DC0  80 1F 00 D0 */	lwz r0, 0xd0(r31)
/* 800D6E84 000D3DC4  28 00 00 00 */	cmplwi r0, 0
/* 800D6E88 000D3DC8  40 82 00 10 */	bne .L_800D6E98
/* 800D6E8C 000D3DCC  38 7F 00 00 */	addi r3, r31, 0
/* 800D6E90 000D3DD0  38 9E 00 00 */	addi r4, r30, 0
/* 800D6E94 000D3DD4  4B FF E7 F1 */	bl __CARDPutControlBlock
.L_800D6E98:
/* 800D6E98 000D3DD8  80 1F 00 D8 */	lwz r0, 0xd8(r31)
/* 800D6E9C 000D3DDC  28 00 00 00 */	cmplwi r0, 0
/* 800D6EA0 000D3DE0  7C 0C 03 78 */	mr r12, r0
/* 800D6EA4 000D3DE4  41 82 00 1C */	beq .L_800D6EC0
/* 800D6EA8 000D3DE8  38 00 00 00 */	li r0, 0
/* 800D6EAC 000D3DEC  7D 88 03 A6 */	mtlr r12
/* 800D6EB0 000D3DF0  90 1F 00 D8 */	stw r0, 0xd8(r31)
/* 800D6EB4 000D3DF4  38 7D 00 00 */	addi r3, r29, 0
/* 800D6EB8 000D3DF8  38 9E 00 00 */	addi r4, r30, 0
/* 800D6EBC 000D3DFC  4E 80 00 21 */	blrl 
.L_800D6EC0:
/* 800D6EC0 000D3E00  80 01 00 24 */	lwz r0, 0x24(r1)
/* 800D6EC4 000D3E04  83 E1 00 1C */	lwz r31, 0x1c(r1)
/* 800D6EC8 000D3E08  83 C1 00 18 */	lwz r30, 0x18(r1)
/* 800D6ECC 000D3E0C  83 A1 00 14 */	lwz r29, 0x14(r1)
/* 800D6ED0 000D3E10  38 21 00 20 */	addi r1, r1, 0x20
/* 800D6ED4 000D3E14  7C 08 03 A6 */	mtlr r0
/* 800D6ED8 000D3E18  4E 80 00 20 */	blr 

.global EraseCallback
EraseCallback:
/* 800D6EDC 000D3E1C  7C 08 02 A6 */	mflr r0
/* 800D6EE0 000D3E20  90 01 00 04 */	stw r0, 4(r1)
/* 800D6EE4 000D3E24  94 21 FF D8 */	stwu r1, -0x28(r1)
/* 800D6EE8 000D3E28  93 E1 00 24 */	stw r31, 0x24(r1)
/* 800D6EEC 000D3E2C  3B E3 00 00 */	addi r31, r3, 0
/* 800D6EF0 000D3E30  3C 60 80 4F */	lis r3, __CARDBlock@ha
/* 800D6EF4 000D3E34  93 C1 00 20 */	stw r30, 0x20(r1)
/* 800D6EF8 000D3E38  1C BF 01 10 */	mulli r5, r31, 0x110
/* 800D6EFC 000D3E3C  93 A1 00 1C */	stw r29, 0x1c(r1)
/* 800D6F00 000D3E40  38 03 5A F0 */	addi r0, r3, __CARDBlock@l
/* 800D6F04 000D3E44  7C 9D 23 79 */	or. r29, r4, r4
/* 800D6F08 000D3E48  7F C0 2A 14 */	add r30, r0, r5
/* 800D6F0C 000D3E4C  41 80 00 3C */	blt .L_800D6F48
/* 800D6F10 000D3E50  80 BE 00 88 */	lwz r5, 0x88(r30)
/* 800D6F14 000D3E54  3C 60 80 0D */	lis r3, WriteCallback@ha
/* 800D6F18 000D3E58  80 1E 00 80 */	lwz r0, 0x80(r30)
/* 800D6F1C 000D3E5C  38 E3 6E 08 */	addi r7, r3, WriteCallback@l
/* 800D6F20 000D3E60  80 7E 00 0C */	lwz r3, 0xc(r30)
/* 800D6F24 000D3E64  7C 00 28 50 */	subf r0, r0, r5
/* 800D6F28 000D3E68  54 00 9B 7E */	srwi r0, r0, 0xd
/* 800D6F2C 000D3E6C  7C 83 01 D6 */	mullw r4, r3, r0
/* 800D6F30 000D3E70  38 C5 00 00 */	addi r6, r5, 0
/* 800D6F34 000D3E74  38 7F 00 00 */	addi r3, r31, 0
/* 800D6F38 000D3E78  38 A0 20 00 */	li r5, 0x2000
/* 800D6F3C 000D3E7C  4B FF FE 61 */	bl __CARDWrite
/* 800D6F40 000D3E80  7C 7D 1B 79 */	or. r29, r3, r3
/* 800D6F44 000D3E84  40 80 00 44 */	bge .L_800D6F88
.L_800D6F48:
/* 800D6F48 000D3E88  80 1E 00 D0 */	lwz r0, 0xd0(r30)
/* 800D6F4C 000D3E8C  28 00 00 00 */	cmplwi r0, 0
/* 800D6F50 000D3E90  40 82 00 10 */	bne .L_800D6F60
/* 800D6F54 000D3E94  38 7E 00 00 */	addi r3, r30, 0
/* 800D6F58 000D3E98  38 9D 00 00 */	addi r4, r29, 0
/* 800D6F5C 000D3E9C  4B FF E7 29 */	bl __CARDPutControlBlock
.L_800D6F60:
/* 800D6F60 000D3EA0  80 1E 00 D8 */	lwz r0, 0xd8(r30)
/* 800D6F64 000D3EA4  28 00 00 00 */	cmplwi r0, 0
/* 800D6F68 000D3EA8  7C 0C 03 78 */	mr r12, r0
/* 800D6F6C 000D3EAC  41 82 00 1C */	beq .L_800D6F88
/* 800D6F70 000D3EB0  38 00 00 00 */	li r0, 0
/* 800D6F74 000D3EB4  7D 88 03 A6 */	mtlr r12
/* 800D6F78 000D3EB8  90 1E 00 D8 */	stw r0, 0xd8(r30)
/* 800D6F7C 000D3EBC  38 7F 00 00 */	addi r3, r31, 0
/* 800D6F80 000D3EC0  38 9D 00 00 */	addi r4, r29, 0
/* 800D6F84 000D3EC4  4E 80 00 21 */	blrl 
.L_800D6F88:
/* 800D6F88 000D3EC8  80 01 00 2C */	lwz r0, 0x2c(r1)
/* 800D6F8C 000D3ECC  83 E1 00 24 */	lwz r31, 0x24(r1)
/* 800D6F90 000D3ED0  83 C1 00 20 */	lwz r30, 0x20(r1)
/* 800D6F94 000D3ED4  83 A1 00 1C */	lwz r29, 0x1c(r1)
/* 800D6F98 000D3ED8  38 21 00 28 */	addi r1, r1, 0x28
/* 800D6F9C 000D3EDC  7C 08 03 A6 */	mtlr r0
/* 800D6FA0 000D3EE0  4E 80 00 20 */	blr 

.global __CARDAllocBlock
__CARDAllocBlock:
/* 800D6FA4 000D3EE4  7C 08 02 A6 */	mflr r0
/* 800D6FA8 000D3EE8  1C E3 01 10 */	mulli r7, r3, 0x110
/* 800D6FAC 000D3EEC  90 01 00 04 */	stw r0, 4(r1)
/* 800D6FB0 000D3EF0  94 21 FF E0 */	stwu r1, -0x20(r1)
/* 800D6FB4 000D3EF4  3C C0 80 4F */	lis r6, __CARDBlock@ha
/* 800D6FB8 000D3EF8  38 06 5A F0 */	addi r0, r6, __CARDBlock@l
/* 800D6FBC 000D3EFC  93 E1 00 1C */	stw r31, 0x1c(r1)
/* 800D6FC0 000D3F00  7D 20 3A 14 */	add r9, r0, r7
/* 800D6FC4 000D3F04  93 C1 00 18 */	stw r30, 0x18(r1)
/* 800D6FC8 000D3F08  80 09 00 00 */	lwz r0, 0(r9)
/* 800D6FCC 000D3F0C  2C 00 00 00 */	cmpwi r0, 0
/* 800D6FD0 000D3F10  40 82 00 0C */	bne .L_800D6FDC
/* 800D6FD4 000D3F14  38 60 FF FD */	li r3, -3
/* 800D6FD8 000D3F18  48 00 00 CC */	b .L_800D70A4
.L_800D6FDC:
/* 800D6FDC 000D3F1C  81 09 00 88 */	lwz r8, 0x88(r9)
/* 800D6FE0 000D3F20  A0 08 00 06 */	lhz r0, 6(r8)
/* 800D6FE4 000D3F24  7C 00 20 40 */	cmplw r0, r4
/* 800D6FE8 000D3F28  40 80 00 0C */	bge .L_800D6FF4
/* 800D6FEC 000D3F2C  38 60 FF F7 */	li r3, -9
/* 800D6FF0 000D3F30  48 00 00 B4 */	b .L_800D70A4
.L_800D6FF4:
/* 800D6FF4 000D3F34  7C 04 00 50 */	subf r0, r4, r0
/* 800D6FF8 000D3F38  B0 08 00 06 */	sth r0, 6(r8)
/* 800D6FFC 000D3F3C  3C C0 00 01 */	lis r6, 0x0000FFFF@ha
/* 800D7000 000D3F40  39 86 FF FF */	addi r12, r6, 0x0000FFFF@l
/* 800D7004 000D3F44  A1 68 00 08 */	lhz r11, 8(r8)
/* 800D7008 000D3F48  38 0C 00 00 */	addi r0, r12, 0
/* 800D700C 000D3F4C  3B C0 00 00 */	li r30, 0
/* 800D7010 000D3F50  48 00 00 7C */	b .L_800D708C
.L_800D7014:
/* 800D7014 000D3F54  A1 49 00 10 */	lhz r10, 0x10(r9)
/* 800D7018 000D3F58  3B DE 00 01 */	addi r30, r30, 1
/* 800D701C 000D3F5C  57 C6 04 3E */	clrlwi r6, r30, 0x10
/* 800D7020 000D3F60  38 EA FF FB */	addi r7, r10, -5
/* 800D7024 000D3F64  7C 07 30 00 */	cmpw r7, r6
/* 800D7028 000D3F68  40 80 00 0C */	bge .L_800D7034
/* 800D702C 000D3F6C  38 60 FF FA */	li r3, -6
/* 800D7030 000D3F70  48 00 00 74 */	b .L_800D70A4
.L_800D7034:
/* 800D7034 000D3F74  39 6B 00 01 */	addi r11, r11, 1
/* 800D7038 000D3F78  55 66 04 3E */	clrlwi r6, r11, 0x10
/* 800D703C 000D3F7C  28 06 00 05 */	cmplwi r6, 5
/* 800D7040 000D3F80  41 80 00 0C */	blt .L_800D704C
/* 800D7044 000D3F84  7C 06 50 40 */	cmplw r6, r10
/* 800D7048 000D3F88  41 80 00 08 */	blt .L_800D7050
.L_800D704C:
/* 800D704C 000D3F8C  39 60 00 05 */	li r11, 5
.L_800D7050:
/* 800D7050 000D3F90  55 66 0B FC */	rlwinm r6, r11, 1, 0xf, 0x1e
/* 800D7054 000D3F94  7C E8 32 14 */	add r7, r8, r6
/* 800D7058 000D3F98  A0 C7 00 00 */	lhz r6, 0(r7)
/* 800D705C 000D3F9C  28 06 00 00 */	cmplwi r6, 0
/* 800D7060 000D3FA0  40 82 00 2C */	bne .L_800D708C
/* 800D7064 000D3FA4  55 86 04 3E */	clrlwi r6, r12, 0x10
/* 800D7068 000D3FA8  28 06 FF FF */	cmplwi r6, 0xffff
/* 800D706C 000D3FAC  40 82 00 0C */	bne .L_800D7078
/* 800D7070 000D3FB0  7D 6C 5B 78 */	mr r12, r11
/* 800D7074 000D3FB4  48 00 00 0C */	b .L_800D7080
.L_800D7078:
/* 800D7078 000D3FB8  57 E6 0B FC */	rlwinm r6, r31, 1, 0xf, 0x1e
/* 800D707C 000D3FBC  7D 68 33 2E */	sthx r11, r8, r6
.L_800D7080:
/* 800D7080 000D3FC0  B0 07 00 00 */	sth r0, 0(r7)
/* 800D7084 000D3FC4  3B EB 00 00 */	addi r31, r11, 0
/* 800D7088 000D3FC8  38 84 FF FF */	addi r4, r4, -1
.L_800D708C:
/* 800D708C 000D3FCC  28 04 00 00 */	cmplwi r4, 0
/* 800D7090 000D3FD0  40 82 FF 84 */	bne .L_800D7014
/* 800D7094 000D3FD4  B1 68 00 08 */	sth r11, 8(r8)
/* 800D7098 000D3FD8  7D 04 43 78 */	mr r4, r8
/* 800D709C 000D3FDC  B1 89 00 BE */	sth r12, 0xbe(r9)
/* 800D70A0 000D3FE0  48 00 00 1D */	bl __CARDUpdateFatBlock
.L_800D70A4:
/* 800D70A4 000D3FE4  80 01 00 24 */	lwz r0, 0x24(r1)
/* 800D70A8 000D3FE8  83 E1 00 1C */	lwz r31, 0x1c(r1)
/* 800D70AC 000D3FEC  83 C1 00 18 */	lwz r30, 0x18(r1)
/* 800D70B0 000D3FF0  38 21 00 20 */	addi r1, r1, 0x20
/* 800D70B4 000D3FF4  7C 08 03 A6 */	mtlr r0
/* 800D70B8 000D3FF8  4E 80 00 20 */	blr 

.global __CARDUpdateFatBlock
__CARDUpdateFatBlock:
/* 800D70BC 000D3FFC  7C 08 02 A6 */	mflr r0
/* 800D70C0 000D4000  90 01 00 04 */	stw r0, 4(r1)
/* 800D70C4 000D4004  94 21 FF D8 */	stwu r1, -0x28(r1)
/* 800D70C8 000D4008  93 E1 00 24 */	stw r31, 0x24(r1)
/* 800D70CC 000D400C  93 C1 00 20 */	stw r30, 0x20(r1)
/* 800D70D0 000D4010  3B C5 00 00 */	addi r30, r5, 0
/* 800D70D4 000D4014  93 A1 00 1C */	stw r29, 0x1c(r1)
/* 800D70D8 000D4018  3B A4 00 00 */	addi r29, r4, 0
/* 800D70DC 000D401C  38 BD 00 00 */	addi r5, r29, 0
/* 800D70E0 000D4020  93 81 00 18 */	stw r28, 0x18(r1)
/* 800D70E4 000D4024  3B 83 00 00 */	addi r28, r3, 0
/* 800D70E8 000D4028  38 DD 00 02 */	addi r6, r29, 2
/* 800D70EC 000D402C  A0 64 00 04 */	lhz r3, 4(r4)
/* 800D70F0 000D4030  1C 9C 01 10 */	mulli r4, r28, 0x110
/* 800D70F4 000D4034  38 03 00 01 */	addi r0, r3, 1
/* 800D70F8 000D4038  3C 60 80 4F */	lis r3, __CARDBlock@ha
/* 800D70FC 000D403C  B0 1D 00 04 */	sth r0, 4(r29)
/* 800D7100 000D4040  38 03 5A F0 */	addi r0, r3, __CARDBlock@l
/* 800D7104 000D4044  7F E0 22 14 */	add r31, r0, r4
/* 800D7108 000D4048  38 7D 00 04 */	addi r3, r29, 4
/* 800D710C 000D404C  38 80 1F FC */	li r4, 0x1ffc
/* 800D7110 000D4050  48 00 02 BD */	bl __CARDCheckSum
/* 800D7114 000D4054  38 7D 00 00 */	addi r3, r29, 0
/* 800D7118 000D4058  38 80 20 00 */	li r4, 0x2000
/* 800D711C 000D405C  48 01 56 2D */	bl DCStoreRange
/* 800D7120 000D4060  93 DF 00 D8 */	stw r30, 0xd8(r31)
/* 800D7124 000D4064  3C 60 80 0D */	lis r3, EraseCallback@ha
/* 800D7128 000D4068  38 A3 6E DC */	addi r5, r3, EraseCallback@l
/* 800D712C 000D406C  80 1F 00 80 */	lwz r0, 0x80(r31)
/* 800D7130 000D4070  7F 83 E3 78 */	mr r3, r28
/* 800D7134 000D4074  80 9F 00 0C */	lwz r4, 0xc(r31)
/* 800D7138 000D4078  7C 00 E8 50 */	subf r0, r0, r29
/* 800D713C 000D407C  54 00 9B 7E */	srwi r0, r0, 0xd
/* 800D7140 000D4080  7C 84 01 D6 */	mullw r4, r4, r0
/* 800D7144 000D4084  4B FF E2 BD */	bl __CARDEraseSector
/* 800D7148 000D4088  80 01 00 2C */	lwz r0, 0x2c(r1)
/* 800D714C 000D408C  83 E1 00 24 */	lwz r31, 0x24(r1)
/* 800D7150 000D4090  83 C1 00 20 */	lwz r30, 0x20(r1)
/* 800D7154 000D4094  83 A1 00 1C */	lwz r29, 0x1c(r1)
/* 800D7158 000D4098  83 81 00 18 */	lwz r28, 0x18(r1)
/* 800D715C 000D409C  38 21 00 28 */	addi r1, r1, 0x28
/* 800D7160 000D40A0  7C 08 03 A6 */	mtlr r0
/* 800D7164 000D40A4  4E 80 00 20 */	blr 
